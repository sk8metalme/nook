# AI Agent Instructions

このファイルは、シンプルなプロジェクト指示を記述するための`AGENTS.md`の例です。
[Cursor公式ドキュメント](https://docs.cursor.com/ja/context/rules#agentsmd)によると、
`.cursor/rules`の代替として使用できるシンプルなMarkdownファイルです。

## 基本設定

- 日本語で応答してください
- プロフェッショナルで丁寧な対応を心がけてください
- コードは読みやすく、保守しやすいものを書いてください
- 常に、より良い判断、実装をするため、時には否定的な意見も述べてください。必ず、理由と代替案を添えてください

## コーディング規約

### 全般
- クリーンコードの原則に従う
- 意味のある変数名を使用
- 関数は単一責任原則に従う
- 適切なエラーハンドリングを実装

### 言語別ガイドライン

#### Java
- Google Java Style Guideに準拠
- Spring Bootのベストプラクティスに従う
- 依存性注入はコンストラクタ経由で

#### PHP
- PSR-12コーディング標準に準拠
- strict_typesを宣言
- 型ヒントと戻り値の型を使用

#### Perl
- use strict; use warnings; use utf8; 必須
- モダンPerlイディオムを使用
- perlcritic準拠

## プロジェクト構成

```
src/
  controllers/   # コントローラー
  services/      # ビジネスロジック
  repositories/  # データアクセス層
  models/        # データモデル
  utils/         # ユーティリティ関数
tests/          # テストコード
docs/           # ドキュメント
```

## セキュリティ

- 機密情報をハードコードしない
- すべての入力値を検証
- SQLインジェクション対策を実施
- XSS対策を実装

## テスト

- 新機能には必ずテストを追加
- カバレッジ95%以上を維持
- エッジケースを考慮
- テスト駆動開発（TDD）を推奨

## ドキュメント
- ドキュメントにコードを記述することはできるだけ避ける。実コードと二重管理になるので
- コードコメントは日本語で記述
- APIエンドポイントをドキュメント化
- 使用例を含める
- READMEを最新に保つ

## Claude Code 連携ガイド

### 目的

ユーザーが 「Claude Codeと相談しながら進めて」 （または類似表現）と指示した場合、
Codex は Claude Code を随時呼び出しながら、複数ターンにわたる協業を行う。

### トリガー
• 正規表現: /Claude.*相談しながら/
• 一度トリガーした後は、ユーザーが明示的に終了を指示するまで 協業モード を維持する。

### 協業ワークフロー (ループ可)

1 PROMPT 準備 最新のユーザー要件 + これまでの議論要約を $PROMPT に格納
2 Claude Code 呼び出し  bash\nclaude <<EOF\n$PROMPT\nEOF\n必要に応じ --max_tokens 等を追加
3 出力貼り付け  Claude Code ➜ セクションに全文、長い場合は要約＋原文リンク
4 Codex コメント  Codex ➜ セクションで Claude Code の提案を分析・統合し、次アクションを提示
5 継続判定  ユーザー入力 or プラン継続で 1〜4 を繰り返す。「Codexコラボ終了」「ひとまずOK」等で通常モード復帰

形式テンプレート

**Claude Code ➜**
<Claude Code からの応答>
**Codex ➜**
<統合コメント & 次アクション>

---

注: より詳細な制御が必要な場合は、`.cursor/rules/*.mdc`形式のProject Rulesを使用することを推奨します。
